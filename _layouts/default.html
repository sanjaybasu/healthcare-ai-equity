<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
  <meta name="description" content="{{ page.description | default: site.description }}">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
  
  <!-- SEO -->
  {% seo %}
  
  <!-- MathJax Configuration -->
  {% if page.mathjax or site.mathjax %}
    {% include mathjax.html %}
  {% endif %}
</head>
<body>
  <!-- Navigation -->
  <nav>
    <div class="container">
      <a href="{{ '/' | relative_url }}" class="nav-home">
        <strong>{{ site.title }}</strong>
      </a>
      <div class="nav-links">
        <a href="{{ '/' | relative_url }}">Home</a>
        <a href="{{ '/chapters' | relative_url }}">Chapters</a>
        <a href="https://github.com/sanjaybasu/healthcare-ai-equity" target="_blank">GitHub</a>
      </div>
    </div>
  </nav>
  
  <!-- Main Content -->
  <main class="container">
    <article class="content">
      {{ content }}
    </article>
    
    {% if page.chapter_number %}
    <!-- Chapter Navigation -->
    <nav class="chapter-nav">
      {% comment %}Find current chapter in data file{% endcomment %}
      {% assign current_index = -1 %}
      {% for chapter in site.data.chapters.chapters %}
        {% if chapter.num == page.chapter_number %}
          {% assign current_index = forloop.index0 %}
          {% break %}
        {% endif %}
      {% endfor %}
      
      {% comment %}Previous chapter{% endcomment %}
      {% if current_index > 0 %}
        {% assign prev_index = current_index | minus: 1 %}
        {% assign prev_chapter = site.data.chapters.chapters[prev_index] %}
        <a href="{{ '/chapters/' | append: prev_chapter.file | append: '/' | relative_url }}" class="prev-chapter">
          ← Previous Chapter
        </a>
      {% else %}
        <span class="disabled"></span>
      {% endif %}
      
      <a href="{{ '/chapters' | relative_url }}" class="all-chapters">
        All Chapters
      </a>
      
      {% comment %}Next chapter{% endcomment %}
      {% assign next_index = current_index | plus: 1 %}
      {% if next_index < site.data.chapters.chapters.size %}
        {% assign next_chapter = site.data.chapters.chapters[next_index] %}
        <a href="{{ '/chapters/' | append: next_chapter.file | append: '/' | relative_url }}" class="next-chapter">
          Next Chapter →
        </a>
      {% else %}
        <span class="disabled"></span>
      {% endif %}
    </nav>
    {% endif %}
  </main>
  
  <!-- Footer -->
  <footer>
    <div class="container">
      <p>&copy; 2025 {{ site.author }}. Licensed under <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a>.</p>
      <p>
        <a href="https://github.com/sanjaybasu/healthcare-ai-equity/issues" target="_blank">Report an Issue</a> | 
        <a href="https://github.com/sanjaybasu/healthcare-ai-equity/blob/main/CONTRIBUTING.md" target="_blank">Contribute</a>
      </p>
    </div>
  </footer>
  
  <!-- Syntax Highlighting -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/r.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/sql.min.js"></script>
  <script>
    hljs.highlightAll();
    
    // Add copy buttons to code blocks
    document.querySelectorAll('pre code').forEach((block) => {
      const button = document.createElement('button');
      button.className = 'copy-code-button';
      button.textContent = 'Copy';
      button.addEventListener('click', () => {
        navigator.clipboard.writeText(block.textContent).then(() => {
          button.textContent = 'Copied!';
          setTimeout(() => { button.textContent = 'Copy'; }, 2000);
        });
      });
      block.parentNode.insertBefore(button, block);
    });
  </script>
</body>
</html>
